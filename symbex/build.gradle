/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */


task compile {
  group = "Symbex build"
}

task submodules(type: Exec) {
  commandLine 'git submodule update --init --recursive'
}

task core(type: Exec) {
  commandLine 'cd jdart && git checkout master && ant'
}

task jconstraints(type: Exec) {
  commandLine 'cd jconstraints && git checkout jconstraints-0.9.1 && mvn install'
}

task z3(type: Exec) {
  File z3 = new File('z3.zip')
  if (!z3.exists()) {
    new URL('https://github.com/Z3Prover/z3/releases/download/z3-4.4.1/z3-4.4.1-x64-ubuntu-14.04.zip').withInputStream{ i -> z3.withOutputStream{ it << i }}
  }
  commandLine 'unzip z3.zip'
  commandLine 'cd z3/bin && mvn install:install-file -Dfile=com.microsoft.z3.jar -DgroupId=com.microsoft -DartifactId=z3 -Dversion=4.4.1 -Dpackaging=jar'
  commandLine 'export LD_LIBRARY_PATH=`pwd`/z3/bin:LD_LIBRARY_PATH'
}

task jdart(type: Exec) {
  commandLine 'cd jdart && git checkout master && ant'
}

task jconstraintsZ3(type: Exec) {
  commandLine 'cd jconstraints-z3 && git checkout jconstraints-z3-0.9.0 && mvn install'
}

task make(type: Exec) {
  commandLine 'make'
}

compile.dependsOn make
//compile.dependsOn submodules
//compile.dependsOn core
//compile.dependsOn jconstraints
//compile.dependsOn z3
//compile.dependsOn jconstraintsZ3
//compile.dependsOn jdart
